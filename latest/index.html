<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Andrey Antukh, &lt;niwi@niwi.nz&gt;">
<title>buddy-core - Cryptographic Api</title>
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f0f0f0; }
.listingblock .pygments .tok-c { color: #60a0b0; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #007020; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #007020 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #007020 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #902000 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #40a070 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #4070a0 } /* Literal.String */
.listingblock .pygments .tok-na { color: #4070a0 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #007020 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #60add5 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #555555; font-weight: bold } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #d55537; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #007020 } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #06287e } /* Name.Function */
.listingblock .pygments .tok-nl { color: #002070; font-weight: bold } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #062873; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #bb60d5 } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #007020; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #40a070 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #40a070 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #40a070 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #40a070 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #40a070 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #4070a0 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #4070a0 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #4070a0 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #4070a0 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #c65d09 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #235388 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #4070a0 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #517918 } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #007020 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #bb60d5 } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #bb60d5 } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #bb60d5 } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #40a070 } /* Literal.Number.Integer.Long */
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic|Liberation+Mono:400|Roboto+Slab:400,700"/>
<link rel="stylesheet" href="https://www.niwi.nz/_assets/asciidoctor-styles/simple-red-titles/stylesheet.css"/>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>buddy-core - Cryptographic Api</h1>
<div class="details">
<span id="author" class="author">Andrey Antukh, &lt;niwi@niwi.nz&gt;</span><br>
<span id="revdate">0.6.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#project-maturity">Project Maturity</a></li>
<li><a href="#install">Install</a>
<ul class="sectlevel2">
<li><a href="#requirements">Requirements</a></li>
<li><a href="#leiningen">Leiningen</a></li>
<li><a href="#gradle">Gradle</a></li>
</ul>
</li>
<li><a href="#hash-algorithms-digest">Hash algorithms (digest)</a>
<ul class="sectlevel2">
<li><a href="#basic-usage">Basic usage</a></li>
<li><a href="#advanced-usage">Advanced usage</a></li>
</ul>
</li>
<li><a href="#mac-algorithms">Mac algorithms</a>
<ul class="sectlevel2">
<li><a href="#hmac">HMac</a></li>
<li><a href="#shmac-salted">SHMac (Salted)</a></li>
<li><a href="#poly1305">Poly1305</a></li>
</ul>
</li>
<li><a href="#public-private-keypairs">Public/Private keypairs</a>
<ul class="sectlevel2">
<li><a href="#rsa-keypair">RSA Keypair</a></li>
<li><a href="#ecdsa-keypair">ECDSA Keypair</a></li>
</ul>
</li>
<li><a href="#digital-signatures">Digital Signatures</a>
<ul class="sectlevel2">
<li><a href="#rsassa-pss">RSASSA PSS</a></li>
<li><a href="#rsassa-pkcs1-v1-5">RSASSA PKCS1 v1.5</a></li>
<li><a href="#eliptic-curve-dsa">Eliptic Curve DSA</a></li>
</ul>
</li>
<li><a href="#key-derivation-functions">Key Derivation Functions</a>
<ul class="sectlevel2">
<li><a href="#hkdf">HKDF</a></li>
<li><a href="#kdf1-2">KDF1/2</a></li>
<li><a href="#counter-mode-kdf">Counter Mode KDF</a></li>
<li><a href="#feedback-mode-kdf">Feedback Mode KDF</a></li>
<li><a href="#double-pipeline-iteration-mode-kdf">Double-Pipeline Iteration Mode KDF</a></li>
</ul>
</li>
<li><a href="#ciphers">Ciphers</a>
<ul class="sectlevel2">
<li><a href="#block-ciphers">Block Ciphers</a></li>
<li><a href="#stream-ciphers">Stream Ciphers</a></li>
<li><a href="#high-level-encryption-schemes">High level encryption schemes</a></li>
</ul>
</li>
<li><a href="#paddings">Paddings</a></li>
<li><a href="#nonces-and-salts">Nonces and Salts</a></li>
<li><a href="#codecs-bytes">Codecs &amp; Bytes</a></li>
<li><a href="#faq">FAQ</a></li>
<li><a href="#developers-guide">Developers Guide</a>
<ul class="sectlevel2">
<li><a href="#contributing">Contributing</a></li>
<li><a href="#philosophy">Philosophy</a></li>
<li><a href="#source-code">Source Code</a></li>
<li><a href="#run-tests">Run tests</a></li>
<li><a href="#license">License</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction"><a class="link" href="#introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Buddy <strong>core</strong> module is dedicated to cryptographic api.</p>
</div>
<div class="paragraph">
<p>Including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cryptographic hash algorithms (digest)</p>
</li>
<li>
<p>key derivation algorithms (kdf)</p>
</li>
<li>
<p>digital signatures</p>
</li>
<li>
<p>message authentication (mac)</p>
</li>
<li>
<p>block ciphers</p>
</li>
<li>
<p>stream ciphers</p>
</li>
<li>
<p>padding schemes</p>
</li>
<li>
<p>nonces and salts</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="project-maturity"><a class="link" href="#project-maturity">Project Maturity</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since <em>buddy-core</em> is a young project there can be some API breakage.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install"><a class="link" href="#install">Install</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section covers the <em>buddy-core</em> library installing process and its requirements.</p>
</div>
<div class="sect2">
<h3 id="requirements"><a class="link" href="#requirements">Requirements</a></h3>
<div class="paragraph">
<p><em>buddy-core</em> is tested with these platforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDK7</p>
</li>
<li>
<p>JDK8</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="leiningen"><a class="link" href="#leiningen">Leiningen</a></h3>
<div class="paragraph">
<p>The simplest way to use <em>buddy-core</em> in a clojure project, is by including it in the dependency
vector on your <strong><em>project.clj</em></strong> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">[</span><span class="tok-nv">buddy/buddy-core</span> <span class="tok-s">&quot;0.6.0&quot;</span><span class="tok-p">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gradle"><a class="link" href="#gradle">Gradle</a></h3>
<div class="paragraph">
<p>If you are using gradle, this is a dependency line for gradle dsl:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span class="tok-n">compile</span> <span class="tok-s2">&quot;buddy:buddy-core:0.6.0&quot;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hash-algorithms-digest"><a class="link" href="#hash-algorithms-digest">Hash algorithms (digest)</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>All hash algorithms are located in the <code>buddy.core.hash</code> namespace.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Available hash algorithms</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hash algorithm name</th>
<th class="tableblock halign-left valign-top">Digest size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">160</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256, 384, 512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256, 384, 512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MD5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tiger</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">192</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="basic-usage"><a class="link" href="#basic-usage">Basic usage</a></h3>
<div class="listingblock">
<div class="title">Import namespace example:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.hash</span> <span class="tok-ss">:as</span> <span class="tok-nv">hash</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:refer</span> <span class="tok-ss">:all</span><span class="tok-p">])</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Usage examples:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">hash/sha256</span> <span class="tok-s">&quot;foo bar&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; -&gt; #&lt;byte[] [B@162a657e&gt;</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">hash/sha256</span> <span class="tok-s">&quot;foo bar&quot;</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; -&gt; &quot;fbc1a9f858ea9e177916964bd88c3d37b91a1e84412765e29950777f265c4b75&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced-usage"><a class="link" href="#advanced-usage">Advanced usage</a></h3>
<div class="paragraph">
<p>Hash functions are implemented using protocols and can be extended
to other types. The default implementations come with support
for file-like objects (<strong>File</strong>, <strong>URL</strong>, URI* and <strong>InputStream</strong>).</p>
</div>
<div class="listingblock">
<div class="title">Make hash of file example:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-c1">;; Additional import for easy open files</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">clojure.java.io</span> <span class="tok-ss">:as</span> <span class="tok-nv">io</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">hash/sha256</span> <span class="tok-p">(</span><span class="tok-nf">io/input-stream</span> <span class="tok-s">&quot;/tmp/some-file&quot;</span><span class="tok-p">))</span>
    <span class="tok-p">(</span><span class="tok-nf">bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; -&gt; &quot;bba878639499c8449f69efbfc699413eebfaf41d4b7a7faa560bfaf7e93a43dd&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can extend it for your own types using the
<strong>buddy.core.hash/Digest</strong> protocol:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defprotocol </span><span class="tok-nv">Digest</span>
  <span class="tok-p">(</span><span class="tok-nf">digest*</span> <span class="tok-p">[</span><span class="tok-nv">data</span> <span class="tok-nv">algorithm</span><span class="tok-p">]))</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Functions like <strong>sha256</strong> are aliases for the more generic
function <strong>digest</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-algorithms"><a class="link" href="#mac-algorithms">Mac algorithms</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Buddy comes with three mac implementations: <strong>HMac</strong>, <strong>SHMac</strong> and <strong>Poly1305</strong>.</p>
</div>
<div class="sect2">
<h3 id="hmac"><a class="link" href="#hmac">HMac</a></h3>
<div class="paragraph">
<p>This is a hash based mac algorithm and it is available in <strong>buddy.core.mac.hmac</strong>
namespace.</p>
</div>
<div class="sect3">
<h4 id="basic-usage-2"><a class="link" href="#basic-usage-2">Basic usage</a></h4>
<div class="listingblock">
<div class="title">Generate a hmac from string input</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-c1">;; Import required namespaces</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.mac.hmac</span> <span class="tok-ss">:as</span> <span class="tok-nv">hmac</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>

<span class="tok-c1">;; Generate sha256 hmac over string</span>
<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">hmac/hash</span> <span class="tok-s">&quot;foo bar&quot;</span> <span class="tok-s">&quot;mysecretkey&quot;</span> <span class="tok-ss">:sha256</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;61849448bdbb67b39d609471eead667e65b0d1b9e01b1c3bf7aa56b83e9c8083&quot;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Verify one hmac</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">hmac/verify</span> <span class="tok-s">&quot;foo bar&quot;</span> <span class="tok-s">&quot;61849448bdbb67b...&quot;</span> <span class="tok-s">&quot;mysecretkey&quot;</span> <span class="tok-ss">:sha256</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The key parameter can be any type that implements the <strong>ByteArray</strong> protocol
defined in the <code>buddy.core.codecs</code> namespace. It comes with default implementations for
<code>byte[]</code> and <code>java.lang.String</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="hmac-for-file-like-objects"><a class="link" href="#hmac-for-file-like-objects">HMac for file like objects</a></h4>
<div class="paragraph">
<p>Like hash functions, hmac is implemented using Clojure
protocols and comes with default implementations for: String, byte[],
<strong>File</strong>, <strong>URL</strong>, <strong>URI</strong> and <strong>InputStream</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">clojure.java.io</span> <span class="tok-ss">:as</span> <span class="tok-nv">io</span><span class="tok-p">])</span>

<span class="tok-c1">;; Generate hmac for file</span>
<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">io/input-stream</span> <span class="tok-s">&quot;/tmp/somefile&quot;</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">hmac/hash</span> <span class="tok-s">&quot;mysecretkey&quot;</span> <span class="tok-ss">:sha256</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;4cb793e600848da2053238003fce4c010233c49df3e6a04119b4287eb464c27e&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="advanced-usage-2"><a class="link" href="#advanced-usage-2">Advanced usage</a></h4>
<div class="paragraph">
<p>You can extend it for your own types using <code>buddy.core.mac.hmac/IHMac</code> protocol, that looks
like that one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defprotocol </span><span class="tok-nv">IHMac</span>
  <span class="tok-p">(</span><span class="tok-nf">hash*</span> <span class="tok-p">[</span><span class="tok-nv">data</span> <span class="tok-nb">key </span><span class="tok-nv">algorithm</span><span class="tok-p">])</span>
  <span class="tok-p">(</span><span class="tok-nf">verify*</span> <span class="tok-p">[</span><span class="tok-nv">data</span> <span class="tok-nv">signature</span> <span class="tok-nb">key </span><span class="tok-nv">alg</span><span class="tok-p">]))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Behind the scenes of the high level api, a low level api is already defined with protocols and
you can use it for your purposes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.mac.proto</span> <span class="tok-ss">:as</span> <span class="tok-nv">impl</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">engine</span> <span class="tok-p">(</span><span class="tok-nf">hmac/hmac-engine</span> <span class="tok-s">&quot;secret&quot;</span> <span class="tok-ss">:sha256</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nf">impl/update!</span> <span class="tok-nv">engine</span> <span class="tok-p">(</span><span class="tok-nf">codecs/str-&gt;bytes</span> <span class="tok-s">&quot;My first data&quot;</span><span class="tok-p">))</span>
  <span class="tok-p">(</span><span class="tok-nf">impl/update!</span> <span class="tok-nv">engine</span> <span class="tok-p">(</span><span class="tok-nf">codecs/str-&gt;bytes</span> <span class="tok-s">&quot;My second data&quot;</span><span class="tok-p">))</span>
  <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span> <span class="tok-p">(</span><span class="tok-nf">impl/end!</span> <span class="tok-nv">engine</span><span class="tok-p">)))</span>
<span class="tok-c1">;; &quot;924c4b82a56c0115eb9...&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This also applies to the rest of mac implementations found in <strong>buddy-core</strong> library.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shmac-salted"><a class="link" href="#shmac-salted">SHMac (Salted)</a></h3>
<div class="paragraph">
<p>This is a salted variant of hmac algorithm and is available in <strong>buddy.core.mac.shmac</strong>
namespace.</p>
</div>
<div class="sect3">
<h4 id="usage-example"><a class="link" href="#usage-example">Usage example</a></h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-c1">;; Import required namespaces</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.mac.hmac</span> <span class="tok-ss">:as</span> <span class="tok-nv">shmac</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>

<span class="tok-c1">;; Generate sha256 shmac over string</span>
<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">shmac/hash</span> <span class="tok-s">&quot;foo bar&quot;</span> <span class="tok-s">&quot;salt&quot;</span> <span class="tok-s">&quot;mysecretkey&quot;</span> <span class="tok-ss">:sha256</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;bd5f7a0040430a73f4845bac8f980c6398b4baae8a22efcc22038be0f4dd9678&quot;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="poly1305"><a class="link" href="#poly1305">Poly1305</a></h3>
<div class="paragraph">
<p>Poly1305 is a cryptographic message authentication code
(MAC) written by Daniel J. Bernstein. It can be used to verify the
data integrity and the authenticity of a message.</p>
</div>
<div class="paragraph">
<p>The security of Poly1305 is very close to the block cipher algorithm.
As a result, the only way for an attacker to break Poly1305 is to break
the cipher.</p>
</div>
<div class="paragraph">
<p>Poly1305 offers cipher replaceability. If anything goes wrong with
one, it can be substituted by another with identical security
guarantees.</p>
</div>
<div class="paragraph">
<p>Unlike <strong>HMac</strong>, it requires an initialization vector (IV). An IV is
like a salt. It should be generated using a strong random number
generator for security guarantees. Also, the IV should be of the same
length as the chosen cipher block size.</p>
</div>
<div class="sect3">
<h4 id="basic-usage-3"><a class="link" href="#basic-usage-3">Basic usage</a></h4>
<div class="paragraph">
<p>The default specification talks about AES as default block cipher,
but buddy comes with support for three block ciphers: AES, Serpent
and Twofish.</p>
</div>
<div class="listingblock">
<div class="title">Make mac using Serpent block cipher with random IV</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.mac.poly1305</span> <span class="tok-ss">:as</span> <span class="tok-nv">poly</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">sig</span> <span class="tok-p">(</span><span class="tok-nf">poly/hash</span> <span class="tok-s">&quot;some-data&quot;</span> <span class="tok-s">&quot;mysecret&quot;</span> <span class="tok-ss">:serpent</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span> <span class="tok-nv">sig</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;1976b1c490c306e7304a59dfacee4207&quot;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="public-private-keypairs"><a class="link" href="#public-private-keypairs">Public/Private keypairs</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before explaining digital signatures, you need to read public/private
keypairs and convert them to usable objects. Buddy has limited support
for reading:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA keypair</p>
</li>
<li>
<p>ECDSA keypair</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="rsa-keypair"><a class="link" href="#rsa-keypair">RSA Keypair</a></h3>
<div class="paragraph">
<p>An RSA keypair is obviously used for RSA encryption/decryption, but it
is also used for making digital signatures with RSA-derived
algorithms.</p>
</div>
<div class="listingblock">
<div class="title">Read keys</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>

<span class="tok-c1">;; The last parameter is optional and is only mandatory</span>
<span class="tok-c1">;; if a private key is encrypted.</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">privkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/privkey.3des.rsa.pem&quot;</span> <span class="tok-s">&quot;secret&quot;</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pubkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/public-key</span> <span class="tok-s">&quot;test/_files/pubkey.3des.rsa.pem&quot;</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Generate a RSA Keypair using openssl.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-c"># Generate AES-256 encrypted private key</span>
openssl genrsa -aes256 -out privkey.pem 2048

<span class="tok-c"># Generate public key from previously created private key.</span>
openssl rsa -pubout -in privkey.pem -out pubkey.pem</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ecdsa-keypair"><a class="link" href="#ecdsa-keypair">ECDSA Keypair</a></h3>
<div class="paragraph">
<p>Like RSA keypairs, ECDSA is also used for making digital signatures
and can be read like in the RSA examples.</p>
</div>
<div class="listingblock">
<div class="title">Read keys.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>

<span class="tok-c1">;; The last parameter is optional and is only mandatory</span>
<span class="tok-c1">;; if a private key is encrypted.</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">privkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/privkey.ecdsa.pem&quot;</span> <span class="tok-s">&quot;secret&quot;</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pubkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/public-key</span> <span class="tok-s">&quot;test/_files/pubkey.ecdsa.pem&quot;</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Generate a ECDSA Keypair using openssl.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-c"># Generate a params file</span>
openssl ecparam -name prime256v1 -out ecparams.pem

<span class="tok-c"># Generate a private key from params file</span>
openssl ecparam -in ecparams.pem -genkey -noout -out ecprivkey.pem

<span class="tok-c"># Generate a public key from private key</span>
openssl ec -in ecprivkey.pem -pubout -out ecpubkey.pem</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="digital-signatures"><a class="link" href="#digital-signatures">Digital Signatures</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Digital Signatures differ from Mac as Mac values are both generated
and verified using the same secret key. Digital Signatures require a
public/private keypair. It signs using a private key and verifies a
signature using a public key.</p>
</div>
<div class="sect2">
<h3 id="rsassa-pss"><a class="link" href="#rsassa-pss">RSASSA PSS</a></h3>
<div class="paragraph">
<p>RSASSA-PSS is an improved probabilistic signature scheme with
appendix. What that means is that you can use a private RSA key
to sign data in combination with some random input.</p>
</div>
<div class="paragraph">
<p>RFC: <a href="http://www.ietf.org/rfc/rfc3447.txt" class="bare">http://www.ietf.org/rfc/rfc3447.txt</a></p>
</div>
<div class="listingblock">
<div class="title">Sign sample string using rsassa-pss.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.sign.rsapss</span> <span class="tok-ss">:as</span> <span class="tok-nv">rsapss</span><span class="tok-p">])</span>

<span class="tok-c1">;; Read private key</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">rsaprivkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/privkey.3des.rsa.pem&quot;</span> <span class="tok-s">&quot;secret&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; Make signature</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">signature</span> <span class="tok-p">(</span><span class="tok-nf">rsapss/sign</span> <span class="tok-s">&quot;foo&quot;</span> <span class="tok-nv">rsaprivkey</span> <span class="tok-ss">:sha256</span><span class="tok-p">))</span>

<span class="tok-c1">;; Now signature contains a byte[] with signature of &quot;foo&quot; string</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Verify signature using rsassa-pss.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-c1">;; Read private key</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">rsapubkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/pubkey.3des.rsa.pem&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; Make verification</span>
<span class="tok-p">(</span><span class="tok-nf">rsapss/verify</span> <span class="tok-s">&quot;foo&quot;</span> <span class="tok-nv">signature</span> <span class="tok-nv">rsapubkey</span> <span class="tok-ss">:sha256</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rsassa-pkcs1-v1-5"><a class="link" href="#rsassa-pkcs1-v1-5">RSASSA PKCS1 v1.5</a></h3>
<div class="paragraph">
<p>RSASSA-PSS is an probabilistic signature scheme with appendix.
What that means is that you can use a private RSA key to sign data.</p>
</div>
<div class="paragraph">
<p>RFC: <a href="http://www.ietf.org/rfc/rfc3447.txt" class="bare">http://www.ietf.org/rfc/rfc3447.txt</a></p>
</div>
<div class="listingblock">
<div class="title">Sign sample string using rsassa-pkcs.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.sign.rsapkcs</span> <span class="tok-ss">:as</span> <span class="tok-nv">rsapkcs</span><span class="tok-p">])</span>

<span class="tok-c1">;; Read private key</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">rsaprivkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/privkey.3des.rsa.pem&quot;</span> <span class="tok-s">&quot;secret&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; Make signature</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">signature</span> <span class="tok-p">(</span><span class="tok-nf">rsapkcs/sign</span> <span class="tok-s">&quot;foo&quot;</span> <span class="tok-nv">rsaprivkey</span> <span class="tok-ss">:sha256</span><span class="tok-p">))</span>

<span class="tok-c1">;; Now signature contains a byte[] with signature of &quot;foo&quot; string</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Verify signature using rsassa-pkcs.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-c1">;; Read private key</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">rsapubkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/pubkey.3des.rsa.pem&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; Make verification</span>
<span class="tok-p">(</span><span class="tok-nf">rsapkcs/verify</span> <span class="tok-s">&quot;foo&quot;</span> <span class="tok-nv">signature</span> <span class="tok-nv">rsapubkey</span> <span class="tok-ss">:sha256</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="eliptic-curve-dsa"><a class="link" href="#eliptic-curve-dsa">Eliptic Curve DSA</a></h3>
<div class="paragraph">
<p>Elliptic Curve Digital Signature Algorithm (ECDSA) is a variant of the
Digital Signature Algorithm (DSA) which uses elliptic curve cryptography.</p>
</div>
<div class="listingblock">
<div class="title">Sign sample string using ecdsa.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.sign.ecdsa</span> <span class="tok-ss">:as</span> <span class="tok-nv">ecdsa</span><span class="tok-p">])</span>

<span class="tok-c1">;; Read private key</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">ecdsaprivkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/privkey.ecdsa.pem&quot;</span> <span class="tok-s">&quot;secret&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; Make signature</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">signature</span> <span class="tok-p">(</span><span class="tok-nf">ecdsa/sign</span> <span class="tok-s">&quot;foo&quot;</span> <span class="tok-nv">ecdsaprivkey</span> <span class="tok-ss">:sha256</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Verify signature using ecdsa.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-c1">;; Read private key</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">ecdsapubkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/pubkey.ecdsa.pem&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; Make verification</span>
<span class="tok-p">(</span><span class="tok-nf">ecdsa/verify</span> <span class="tok-s">&quot;foo&quot;</span> <span class="tok-nv">signature</span> <span class="tok-nv">ecdsapubkey</span> <span class="tok-ss">:sha256</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="key-derivation-functions"><a class="link" href="#key-derivation-functions">Key Derivation Functions</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Key derivation functions are often used in conjunction with non-secret parameters
to derive one or more keys from a common secret value.</p>
</div>
<div class="paragraph">
<p><strong>buddy</strong> commes with several of them:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Supported key derivation functions.</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Constructor</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HKDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.kdf/hkdf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HMAC based KDF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KDF1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.kdf/kdf1</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KDF2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.kdf/kdf2</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMKDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.kdf/cmkdf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter Mode KDF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FMKDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.kdf/fmkdf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feedback Mode KDF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DPIMKDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.kdf/dpimkdf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double-Pipeline Iteration Mode KDF</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>All key derivation functions work with byte arrays. For the
following examples, the functions in <code>buddy.core.codecs</code> convert
strings to byte arrays.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="hkdf"><a class="link" href="#hkdf">HKDF</a></h3>
<div class="paragraph">
<p>HMAC-based Extract-and-Expand Key Derivation Function (HKDF) is implemented according to IETF RFC 5869</p>
</div>
<div class="listingblock">
<div class="title">Example using hkdf</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.kdf</span> <span class="tok-ss">:as</span> <span class="tok-nv">kdf</span><span class="tok-p">])</span>

<span class="tok-c1">;; Using hkdf derivation functions. It requires a</span>
<span class="tok-c1">;; key, salt and optionally info field that can</span>
<span class="tok-c1">;; contain any random data.</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">kfn</span> <span class="tok-p">(</span><span class="tok-nf">kdf/hkdf</span> <span class="tok-p">(</span><span class="tok-nf">codecs/str-&gt;bytes</span> <span class="tok-s">&quot;mysecretkey&quot;</span><span class="tok-p">)</span>
                    <span class="tok-p">(</span><span class="tok-nf">codecs/str-&gt;bytes</span> <span class="tok-s">&quot;mypublicsalt&quot;</span><span class="tok-p">)</span>
                    <span class="tok-nv">nil</span> <span class="tok-c1">;; info parameter can be nil</span>
                    <span class="tok-ss">:sha256</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/generate-byte-array!</span> <span class="tok-nv">kfn</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
      <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">)))</span>

<span class="tok-c1">;; =&gt; &quot;0faba553152fce4f&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kdf1-2"><a class="link" href="#kdf1-2">KDF1/2</a></h3>
<div class="paragraph">
<p>KDF1/2 hash-based key derivation functions for derived keys and ivs as defined by IEEE P1363a/ISO 18033.</p>
</div>
<div class="listingblock">
<div class="title">Example using kdf1 or kdf2</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.kdf</span> <span class="tok-ss">:as</span> <span class="tok-nv">kdf</span><span class="tok-p">])</span>

<span class="tok-c1">;; kdf1 and kdf2 are very similar and have the same</span>
<span class="tok-c1">;; constructor signature. Requires: key data, salt</span>
<span class="tok-c1">;; and hash algorithm keyword.</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">kfn</span> <span class="tok-p">(</span><span class="tok-nf">kdf/kdf2</span> <span class="tok-p">(</span><span class="tok-nf">codecs/str-&gt;bytes</span> <span class="tok-s">&quot;mysecretkey&quot;</span><span class="tok-p">)</span>
                    <span class="tok-p">(</span><span class="tok-nf">codecs/str-&gt;bytes</span> <span class="tok-s">&quot;mypublicsalt&quot;</span><span class="tok-p">)</span>
                    <span class="tok-ss">:sha256</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/generate-byte-array!</span> <span class="tok-nv">kfn</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
      <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">)))</span>

<span class="tok-c1">;; =&gt; &quot;0faba553152fce4f&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="counter-mode-kdf"><a class="link" href="#counter-mode-kdf">Counter Mode KDF</a></h3>
<div class="paragraph">
<p>Hash-based KDF with counter mode defined by the publicly available NIST SP 800-108 specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="feedback-mode-kdf"><a class="link" href="#feedback-mode-kdf">Feedback Mode KDF</a></h3>
<div class="paragraph">
<p>Hash-based KDF with feedback mode defined by the publicly available NIST SP 800-108 specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="double-pipeline-iteration-mode-kdf"><a class="link" href="#double-pipeline-iteration-mode-kdf">Double-Pipeline Iteration Mode KDF</a></h3>
<div class="paragraph">
<p>Hash-based KDF with Double-Pipeline Iteration Mode defined by the publicly available
NIST SP 800-108 specification.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ciphers"><a class="link" href="#ciphers">Ciphers</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ciphers support in buddy is available on <code>buddy.core.crypto</code> namespace.</p>
</div>
<div class="sect2">
<h3 id="block-ciphers"><a class="link" href="#block-ciphers">Block Ciphers</a></h3>
<div class="paragraph">
<p>In cryptography, a block cipher is a deterministic algorithm operating on fixed-length groups of bits,
called blocks, with an unvarying transformation that is specified by a symmetric key.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. This is a list of currently supported block ciphers in buddy</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:aes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Twofish</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:twofish</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Blowfish</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:blowfish</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Additionally, for good security, is mandatory to combine a block cipher with some cipher
mode of operation.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. This is a list of currently supported of cipher mode of operation</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SIC (CTR)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:ctr</code>, <code>:sic</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:cbc</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OFB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:ofb</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:gcm</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
currently buddy comes with limited number of ciphers and modes, but in near future
more many more options should be added.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example encrypt</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.crypto</span> <span class="tok-ss">:as</span> <span class="tok-nv">crypto</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">eng</span>   <span class="tok-p">(</span><span class="tok-nf">crypto/block-cipher</span> <span class="tok-ss">:twofish</span> <span class="tok-ss">:cbc</span><span class="tok-p">)</span>
      <span class="tok-nv">iv16</span>  <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">16</span><span class="tok-p">)</span>
      <span class="tok-nv">key32</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">32</span><span class="tok-p">)</span>
      <span class="tok-nv">data</span>  <span class="tok-p">(</span><span class="tok-nf">codecs/hex-&gt;bytes</span> <span class="tok-s">&quot;000000000000000000000000000000AA&quot;</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nf">crypto/initialize!</span> <span class="tok-nv">eng</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-nv">key32</span> <span class="tok-ss">:iv</span> <span class="tok-nv">iv16</span> <span class="tok-ss">:op</span> <span class="tok-ss">:encrypt</span><span class="tok-p">})</span>
  <span class="tok-p">(</span><span class="tok-nf">crypto/process-bytes!</span> <span class="tok-nv">eng</span> <span class="tok-nv">data</span><span class="tok-p">))</span>

<span class="tok-c1">;; =&gt; #&lt;byte[] [B@efadff9&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>AEAD mode of operations also exposes additional function for caluclate the total size of the
output including the authentication tag: <code>get-output-size</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="stream-ciphers"><a class="link" href="#stream-ciphers">Stream Ciphers</a></h3>
<div class="paragraph">
<p>Stream ciphers differ from block ciphers, in that they works with arbitrary length input
and do not require any additional mode of operation.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. This is a list of currently supported of stream ciphers in buddy</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ChaCha</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:chacha</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example encrypt</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.crypto</span> <span class="tok-ss">:as</span> <span class="tok-nv">crypto</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">eng</span>   <span class="tok-p">(</span><span class="tok-nf">crypto/stream-cipher</span> <span class="tok-ss">:chacha</span><span class="tok-p">)</span>
      <span class="tok-nv">iv8</span>   <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
      <span class="tok-nv">key32</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">32</span><span class="tok-p">)</span>
      <span class="tok-nv">data</span>  <span class="tok-p">(</span><span class="tok-nf">codecs/hex-&gt;bytes</span> <span class="tok-s">&quot;0011&quot;</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nf">crypto/initialize!</span> <span class="tok-nv">eng</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-nv">key32</span> <span class="tok-ss">:iv</span> <span class="tok-nv">iv8</span> <span class="tok-ss">:op</span> <span class="tok-ss">:encrypt</span><span class="tok-p">})</span>
  <span class="tok-p">(</span><span class="tok-nf">crypto/process-bytes!</span> <span class="tok-nv">eng</span> <span class="tok-nv">data</span><span class="tok-p">))</span>

<span class="tok-c1">;; =&gt; #&lt;byte[] [B@efadff9&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the iv and key size depends estrictly on cipher engine, in this case, chacha
engine requires 8 bytes iv.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
for decrypt, only change <code>:op</code> value to <code>:decrypt</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can call <code>crypto/initialize!</code> any times as you want, it simply reinitializes the engine.</p>
</div>
</div>
<div class="sect2">
<h3 id="high-level-encryption-schemes"><a class="link" href="#high-level-encryption-schemes">High level encryption schemes</a></h3>
<div class="paragraph">
<p>Since version 0.6.0, <em>buddy-core</em> comes with high level crypto interface that allows user
encrypt arbitrary length data using one of the well established encryption schemes.</p>
</div>
<div class="paragraph">
<p>The api consists in two simple functions. Let see an example of how to encrypt arbitrary
length text and decrypt it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.crypto</span> <span class="tok-ss">:as</span> <span class="tok-nv">crypto</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.hash</span> <span class="tok-ss">:as</span> <span class="tok-nv">hash</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">original-text</span>
  <span class="tok-p">(</span><span class="tok-nf">codecs/str-&gt;bytes</span> <span class="tok-s">&quot;Hello World.&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">iv</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">16</span><span class="tok-p">))</span>   <span class="tok-c1">;; 16 bytes random iv</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nb">key </span><span class="tok-p">(</span><span class="tok-nf">hash/sha256</span> <span class="tok-s">&quot;mysecret&quot;</span><span class="tok-p">))</span> <span class="tok-c1">;; 32 bytes key</span>

<span class="tok-c1">;; Encrypt the original-text content using previously</span>
<span class="tok-c1">;; declared iv and key.</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">encrypted</span> <span class="tok-p">(</span><span class="tok-nf">crypto/encrypt</span> <span class="tok-nv">original-text</span> <span class="tok-nb">key </span><span class="tok-nv">iv</span>
                               <span class="tok-p">{</span><span class="tok-ss">:algorithm</span> <span class="tok-ss">:aes128-cbc-hmac-sha256</span><span class="tok-p">}))</span>

<span class="tok-c1">;; And now, decrypt it using the same parameters:</span>
<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">crypto/decrypt</span> <span class="tok-nv">encrypted</span> <span class="tok-nb">key </span><span class="tok-nv">iv</span> <span class="tok-p">{</span><span class="tok-ss">:algorithm</span> <span class="tok-ss">:aes128-cbc-hmac-sha256</span><span class="tok-p">})</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;str</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;Hello World.&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a complete list of supported encryption schemes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:aes128-cbc-hmac-sha256</code> (default)</p>
</li>
<li>
<p><code>:aes192-cbc-hmac-sha384</code></p>
</li>
<li>
<p><code>:aes256-cbc-hmac-sha512</code></p>
</li>
<li>
<p><code>:aes128-gcm</code></p>
</li>
<li>
<p><code>:aes192-gcm</code></p>
</li>
<li>
<p><code>:aes256-gcm</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="paddings"><a class="link" href="#paddings">Paddings</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Padding schemes are often used for fill the empty bytes of byte array of data to an concrete
blocksize.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. This is a list of currently supported padding schemes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zero Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:zerobyte</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:pkcs7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:tbc</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Let see an example on how to use it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.padding</span> <span class="tok-ss">:as</span> <span class="tok-nv">padding</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.bytes</span> <span class="tok-ss">:as</span> <span class="tok-nv">bytes</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">data</span> <span class="tok-p">(</span><span class="tok-nf">byte-array</span> <span class="tok-mi">10</span><span class="tok-p">))</span>

<span class="tok-c1">;; Fill the array with byte value 10</span>
<span class="tok-p">(</span><span class="tok-nf">bytes/fill!</span> <span class="tok-nv">data</span> <span class="tok-mi">10</span><span class="tok-p">)</span>

<span class="tok-c1">;; Add padding to the byte array with offset value: 7</span>
<span class="tok-c1">;; This is a side effect and it will mutate the data</span>
<span class="tok-c1">;; byte array.</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">padding/pad!</span> <span class="tok-nv">data</span> <span class="tok-mi">7</span> <span class="tok-ss">:pkcs7</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt;[10 10 10 10 10 10 10 3 3 3]</span>

<span class="tok-c1">;; Also it has the side effect free version of it, that</span>
<span class="tok-c1">;; returns a new byte array.</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">padding/pad</span> <span class="tok-nv">data</span> <span class="tok-mi">7</span> <span class="tok-ss">:pkcs7</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt;[10 10 10 10 10 10 10 3 3 3]</span>


<span class="tok-c1">;; Show the size of applied padding</span>
<span class="tok-p">(</span><span class="tok-nf">padding/count</span> <span class="tok-nv">data</span> <span class="tok-ss">:pkcs7</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 3</span>

<span class="tok-c1">;; Remove the padding</span>
<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">padding/unpad</span> <span class="tok-nv">data</span> <span class="tok-mi">7</span> <span class="tok-ss">:pkcs7</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt;[10 10 10 10 10 10 10 0 0 0]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default padding scheme is <code>:pkcs7</code> and that parameter can be ommited.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nonces-and-salts"><a class="link" href="#nonces-and-salts">Nonces and Salts</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library comes with helpers for generate random salts and cryptographically secure
nonces:</p>
</div>
<div class="listingblock">
<div class="title">Generate a cryptographically secure nonce</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">16</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; [0 0 1 75 -114 49 -91 107 67 -124 -49 -2 -96 100 42 18]</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">16</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; [0 0 1 75 -114 49 -88 -102 92 88 111 69 46 93 1 -86]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>random-nonce</strong> function returns a byte array with minimum length of 8 bytes, because
is the size of the current time in miliseconds.</p>
</div>
<div class="listingblock">
<div class="title">Generate a cryptographically secure salt</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">16</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt;[-50 20 -120 -38 -32 -121 -15 109 86 -99 85 -73 28 -92 -67 -64]</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">16</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; [84 -88 51 120 122 -30 78 -31 -96 -22 119 122 29 -54 -64 -73]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Like <strong>random-nonce</strong> functiom, <strong>random-bytes</strong> returns a byte array but it not have
the limitation of minimum 8 bytes of size.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="codecs-bytes"><a class="link" href="#codecs-bytes">Codecs &amp; Bytes</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library comes with helpers for working with codecs (hex, base64, &#8230;&#8203;) and byte arrays.</p>
</div>
<div class="paragraph">
<p>This is a brief list of available functions:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. Available hash algorithms</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 66%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Namespace/Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/str&#8594;bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts a string into byte array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/bytes&#8594;str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts byte array to string using UTF8 encoding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/bytes&#8594;hex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts byte array to hexadecimal string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/hex&#8594;bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts hexadecimal strings into byte array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/bytes&#8594;base64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts byte array to base64 string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/base64&#8594;bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts base64 string into byte array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/bytes&#8594;safebase64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts byte array into safe url base64 string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/safebase64&#8594;bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts safe url base64 string into byte array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/long&#8594;bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get byte array representation of long</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/bytes&#8594;long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get long from byte array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/bytes?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Predicate for test byte arrays</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/fill!</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fill byte array with data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/slice</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create a new byte array as slice of other</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/copy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy the byte array.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/equals?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constant time equals predicate for byte arrays</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/concat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concat two or more byte arrays</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="faq"><a class="link" href="#faq">FAQ</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Buddy has own cryptographic algorithms implementations?</strong></p>
</div>
<div class="paragraph">
<p>Mainly no, I&#8217;m not cryptography expert and for this I rely on the to battle tested Bouncy Castle java
library that&#8217;s dedicated to this purpose.</p>
</div>
<div class="paragraph">
<p><strong>Buddy will support pgp?</strong></p>
</div>
<div class="paragraph">
<p>Surely not! Because there already exists one good <a href="https://github.com/greglook/clj-pgp">library for that</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="developers-guide"><a class="link" href="#developers-guide">Developers Guide</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="contributing"><a class="link" href="#contributing">Contributing</a></h3>
<div class="paragraph">
<p>Unlike Clojure and other Clojure contributed libraries <em>buddy-core</em> does not have many
restrictions for contributions. Just open an issue or pull request.</p>
</div>
</div>
<div class="sect2">
<h3 id="philosophy"><a class="link" href="#philosophy">Philosophy</a></h3>
<div class="paragraph">
<p>Five most important rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Beautiful is better than ugly.</p>
</li>
<li>
<p>Explicit is better than implicit.</p>
</li>
<li>
<p>Simple is better than complex.</p>
</li>
<li>
<p>Complex is better than complicated.</p>
</li>
<li>
<p>Readability counts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All contributions to <em>buddy-core</em> should keep these important rules in mind.</p>
</div>
</div>
<div class="sect2">
<h3 id="source-code"><a class="link" href="#source-code">Source Code</a></h3>
<div class="paragraph">
<p><em>buddy-core</em> is open source and can be found on <a href="https://github.com/funcool/buddy-core">github</a>.</p>
</div>
<div class="paragraph">
<p>You can clone the public repository with this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">git clone https://github.com/funcool/buddy-core</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="run-tests"><a class="link" href="#run-tests">Run tests</a></h3>
<div class="paragraph">
<p>For running tests just execute this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">lein <span class="tok-nb">test</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="license"><a class="link" href="#license">License</a></h3>
<div class="paragraph">
<p><em>buddy-core</em> is licensed under Apache 2.0 License. You can see the complete text
of the license on the root of the repository on <code>LICENSE</code> file.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-06-28 14:33:58 EEST
</div>
</div>
</body>
</html>